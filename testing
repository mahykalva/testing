---landingtoraw_FPWHBN_to_FPWHBN.sql

INSERT INTO `raw_as400us.FPWHBN`
(
    header__change_seq,
	header__change_oper,
	header__change_mast,
	header__stream_position,
	header__operation,
	header__transaction_id,
	header__timestamp,
    BNLOID,
    BNBINL,
    BNCOID,
    BNDVID,
    BNLZID,
    BNBTID,
    BNBNLV,
    BNPICB,
    BNRPTB,
    BNRPFB,
    BNHOLB,
    BNNINB,
    BNHGHT,
    BNWDTH,
    BNDPTH,
    BNVOLU,
    BNFRAR,
    BNLETR,
    BNVELC,
    BNBULD,
    BNCRDT,
    BNCRTM,
    BNCRUS,
    BNCHDT,
    BNCHTM,
    BNCHUS,
    BNCHJB,
    BNCHPG,
    BNCHSQ,
    BNCMTF,
    BNRCST,
    BNRNGE,
    landloaddate,
	rawrowhash,
    rawloaddate,
    sourcemodified
)
SELECT 
	header__change_seq,
	header__change_oper,
	header__change_mast,
	header__stream_position,
	header__operation,
	header__transaction_id,
	header__timestamp,
    BNLOID,
    BNBINL,
    BNCOID,
    BNDVID,
    BNLZID,
    BNBTID,
    BNBNLV,
    BNPICB,
    BNRPTB,
    BNRPFB,
    BNHOLB,
    BNNINB,
    BNHGHT,
    BNWDTH,
    BNDPTH,
    BNVOLU,
    BNFRAR,
    BNLETR,
    BNVELC,
    BNBULD,
    BNCRDT,
    BNCRTM,
    BNCRUS,
    BNCHDT,
    BNCHTM,
    BNCHUS,
    BNCHJB,
    BNCHPG,
    BNCHSQ,
    BNCMTF,
    BNRCST,
    BNRNGE,
    landloaddate,
    CURRENT_TIMESTAMP() as rawloaddate, 
	CAST(FARM_FINGERPRINT(CONCAT(
    IFNULL(BNLOID, ''),
    IFNULL(BNBINL, ''),
    IFNULL(BNCOID, ''),
    IFNULL(BNDVID, ''),
    IFNULL(BNLZID, ''),
    IFNULL(BNBTID, ''),
    IFNULL(CAST(BNBNLV AS STRING), ''),
    IFNULL(BNPICB, ''),
    IFNULL(BNRPTB, ''),
    IFNULL(BNRPFB, ''),
    IFNULL(BNHOLB, ''),
    IFNULL(BNNINB, ''),
    IFNULL(CAST(BNHGHT AS STRING), ''),
    IFNULL(CAST(BNWDTH AS STRING), ''),
    IFNULL(CAST(BNDPTH AS STRING), ''),
    IFNULL(CAST(BNVOLU AS STRING), ''),
    IFNULL(CAST(BNFRAR AS STRING), ''),
    IFNULL(BNLETR, ''),
    IFNULL(BNVELC, ''),
    IFNULL(BNBULD, ''),
    IFNULL(CAST(BNCRDT AS STRING), ''),
    IFNULL(CAST(BNCRTM AS STRING), ''),
    IFNULL(BNCRUS, ''),
    IFNULL(CAST(BNCHDT AS STRING), ''),
    IFNULL(CAST(BNCHTM AS STRING), ''),
    IFNULL(BNCHUS, ''),
    IFNULL(BNCHJB, ''),
    IFNULL(BNCHPG, ''),
    IFNULL(CAST(BNCHSQ AS STRING), ''),
    IFNULL(BNCMTF, ''),
    IFNULL(BNRCST, ''),
    IFNULL(CAST(BNRNGE AS STRING), '')
  )) AS STRING) as rawrowhash,
    DATETIME(landloaddate, 'America/New_York') as sourcemodified
FROM 
    `da-qlk-prd-mscdirect.KATHYS.FPWHBN__CT`
	WHERE landloaddate>(SELECT MAX(landloaddate) FROM `da-qlk-prd-mscdirect.raw_as400us.FPWHBN`);
