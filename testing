---landingtoraw_FPWHTD_to_FPWHTD_IDL.sql

INSERT INTO `raw_as400us.FPWHTD`
(
 header__change_seq,
 header__change_oper,
 header__change_mast,
 header__stream_position,
 header__operation,
 header__transaction_id,
 header__timestamp,
  TDDVID,
  TDLOID,
  TDDATE,
  TDACLN,
  TDIQTY,
  TDVLIN,
  TDLSDT,
  TDLSTM,
  TDLSUS,
  TDLSPG,
  TDLSJB,
  landloaddate,
  rawrowhash,
  rawloaddate,
  sourcemodified
)
SELECT 
	'IDL',
	'IDL',
	'IDL',
	'IDL',
	'IDL',
	'IDL',
	landloaddate,
  TDDVID,
  TDLOID,
  TDDATE,
  TDACLN,
  TDIQTY,
  TDVLIN,
  TDLSDT,
  TDLSTM,
  TDLSUS,
  TDLSPG,
  TDLSJB,
  landloaddate,
  CURRENT_TIMESTAMP() AS rawloaddate,
  CAST(FARM_FINGERPRINT(CONCAT(
    IFNULL(TDDVID, ''),
    IFNULL(TDLOID, ''),
    IFNULL(CAST(TDDATE AS STRING), ''),
    IFNULL(CAST(TDACLN AS STRING), ''),
    IFNULL(CAST(TDIQTY AS STRING), ''),
    IFNULL(CAST(TDVLIN AS STRING), ''),
    IFNULL(CAST(TDLSDT AS STRING), ''),
    IFNULL(CAST(TDLSTM AS STRING), ''),
    IFNULL(TDLSUS, ''),
    IFNULL(TDLSPG, ''),
    IFNULL(TDLSJB, '')
  )) AS STRING ) AS rowhash, 
  DATETIME(landloaddate, 'America/New_York') AS sourcemodified
FROM 
  `da-qlk-prd-mscdirect.KATHYS.FPWHTD`;
